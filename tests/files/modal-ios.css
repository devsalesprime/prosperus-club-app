/**
 * Modal iOS-Proof Styles
 * 
 * Estilos globais para garantir funcionamento perfeito de modais no iOS
 * Adicione este arquivo ao seu index.css ou App.css
 * 
 * @version 1.0.0
 */

/* ============================================
   1. BLOQUEIO DE SCROLL GLOBAL
   ============================================ */

/* Quando scroll está bloqueado (modal aberto) */
body.scroll-locked {
  /* iOS Safari fix */
  position: fixed !important;
  overflow: hidden !important;
  width: 100% !important;
  
  /* Previne zoom ao tocar em inputs (iOS) */
  touch-action: none !important;
  
  /* Previne seleção de texto durante touch */
  -webkit-user-select: none;
  user-select: none;
}

/* ============================================
   2. SAFE AREAS DO IPHONE (Notch, Home Indicator)
   ============================================ */

/* Garante que modais respeitem safe areas */
.modal-safe-area {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* ============================================
   3. SCROLL SUAVE IOS
   ============================================ */

/* Ativa scroll momentum no iOS */
.modal-content-scroll {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  scroll-behavior: smooth;
}

/* Previne bounce scroll nas extremidades */
.modal-content-scroll {
  overscroll-behavior-y: contain;
}

/* ============================================
   4. ANIMAÇÕES DE MODAL
   ============================================ */

/* Fade in do overlay */
@keyframes modal-overlay-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Slide in do modal */
@keyframes modal-slide-in {
  from {
    transform: translateY(20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Aplicar animações */
.modal-overlay {
  animation: modal-overlay-fade-in 0.2s ease-out;
}

.modal-content {
  animation: modal-slide-in 0.3s ease-out;
}

/* ============================================
   5. FIX PARA INPUTS DENTRO DE MODAIS (iOS)
   ============================================ */

/* Previne zoom ao focar em inputs no iOS Safari */
@supports (-webkit-touch-callout: none) {
  /* iOS only */
  body.scroll-locked input,
  body.scroll-locked textarea,
  body.scroll-locked select {
    font-size: 16px !important;
  }
}

/* Garante que inputs dentro de modais sejam acessíveis */
.modal-content input,
.modal-content textarea,
.modal-content select {
  /* Re-habilita touch action para inputs */
  touch-action: auto !important;
  -webkit-user-select: text !important;
  user-select: text !important;
}

/* ============================================
   6. BACKDROP BLUR (Performance otimizada)
   ============================================ */

.modal-backdrop {
  /* Usa backdrop-filter com fallback */
  background-color: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

/* Desativa blur em dispositivos de baixa performance */
@media (prefers-reduced-motion: reduce) {
  .modal-backdrop {
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    background-color: rgba(0, 0, 0, 0.7);
  }
}

/* ============================================
   7. TAILWIND ANIMATIONS (se usar)
   ============================================ */

/* Adicione ao seu tailwind.config.js se necessário */
/*
module.exports = {
  theme: {
    extend: {
      keyframes: {
        'fade-in': {
          '0%': { opacity: '0' },
          '100%': { opacity: '1' },
        },
        'slide-in-from-bottom': {
          '0%': { transform: 'translateY(20px)', opacity: '0' },
          '100%': { transform: 'translateY(0)', opacity: '1' },
        },
      },
      animation: {
        'in': 'fade-in 0.2s ease-out',
        'slide-in-from-bottom-4': 'slide-in-from-bottom 0.3s ease-out',
      },
    },
  },
}
*/

/* ============================================
   8. FIX PARA TECLADO VIRTUAL DO IOS
   ============================================ */

/* Previne que o teclado empurre o modal para fora da tela */
@supports (-webkit-touch-callout: none) {
  /* iOS only */
  .modal-content {
    position: relative;
  }
  
  /* Quando teclado está visível */
  body.scroll-locked .modal-content {
    max-height: 100vh;
    max-height: -webkit-fill-available;
  }
}

/* ============================================
   9. UTILITY CLASSES EXTRAS
   ============================================ */

/* Previne seleção de texto em áreas não interativas */
.no-select {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* Força aceleração de hardware para animações suaves */
.gpu-accelerated {
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: transform, opacity;
}

/* ============================================
   10. DEBUG HELPERS (remover em produção)
   ============================================ */

/* Descomente para visualizar safe areas */
/*
.debug-safe-areas::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-top: env(safe-area-inset-top) solid rgba(255, 0, 0, 0.3);
  border-bottom: env(safe-area-inset-bottom) solid rgba(0, 255, 0, 0.3);
  border-left: env(safe-area-inset-left) solid rgba(0, 0, 255, 0.3);
  border-right: env(safe-area-inset-right) solid rgba(255, 255, 0, 0.3);
  pointer-events: none;
  z-index: 9999;
}
*/

/* Descomente para ver área scrollável */
/*
.modal-content-scroll {
  outline: 2px dashed red;
}
*/

/* ============================================
   11. DARK MODE SUPPORT (Opcional)
   ============================================ */

@media (prefers-color-scheme: dark) {
  .modal-content {
    background-color: #1a1a1a;
    color: #ffffff;
  }
  
  .modal-backdrop {
    background-color: rgba(0, 0, 0, 0.8);
  }
}

/* ============================================
   12. RESPONSIVIDADE
   ============================================ */

/* Mobile pequeno */
@media (max-width: 375px) {
  .modal-content {
    margin: 0.5rem;
    max-width: calc(100vw - 1rem);
  }
}

/* Tablets */
@media (min-width: 768px) {
  .modal-content {
    max-width: 90vw;
  }
}

/* Desktop */
@media (min-width: 1024px) {
  .modal-content {
    max-width: 80vw;
  }
}

/* ============================================
   13. ACESSIBILIDADE
   ============================================ */

/* Foco visível em elementos interativos */
.modal-content button:focus-visible,
.modal-content a:focus-visible,
.modal-content input:focus-visible {
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
}

/* Alto contraste */
@media (prefers-contrast: high) {
  .modal-backdrop {
    background-color: rgba(0, 0, 0, 0.9);
  }
}

/* Redução de movimento */
@media (prefers-reduced-motion: reduce) {
  .modal-overlay,
  .modal-content {
    animation: none !important;
    transition: none !important;
  }
}
